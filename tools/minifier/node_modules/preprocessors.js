var path = require("path");

module.exports.less = function(inSrc, inPath) {
  inPath = path.resolve(process.cwd(), inPath);

  var code = "";
  try {
    var less = require("./less-sync"),
        conf = {
          paths: [path.dirname(inPath)],
          filename: inPath
        };

    less.render(inSrc, conf, function(e, css) {
      if (e) throw e;
      code = css;
    });    

    return code; 
  } catch (e) {
    if (e.code === "MODULE_NOT_FOUND") {
      throw new Error("Please install the less module to use less (npm install less)");
    } else {
      console.error(inPath, e);
    }
  }
};

module.exports.coffee = function(inSrc, compilerModule) {
  try {
    var coffee = require(compilerModule || "coffee-script");
    return coffee.compile(inSrc);
  } catch (e) {
    if (e.code == "MODULE_NOT_FOUND") {
      throw new Error("Please install the coffee-script module to use CoffeeScript (npm install coffee-script)");
    } else {
      console.error(e);     
    }
  }

};
